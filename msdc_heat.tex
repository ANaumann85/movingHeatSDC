\documentclass{article}
\usepackage{amsmath,amssymb}
\usepackage[utf8]{inputenc}

\bibliographystyle{plain}

\begin{document}
 \begin{enumerate}
  \item $\dot u=f(u)+g(u)$, f: schnell, g: langsam
  \item Zeitbereich: $[t_0,t_e]$
  \item Unterteile $[t_0,t_e]$ in N Intervalle: $[t_0,t_1,\dots,t_{N+1}$
  \item Unterteile jedes Teilintervall $[t_m,t_{m+1}]$ in $N_f$ Teilintervalle ($N_{fast}$)
 \end{enumerate}
 Idea stems basicly from \cite{bourlioux2003high}. There are three scales, where both fast scales are threated implicitly.
 Prediktor: (strukturell ist das (ähnlich) eines M[IF]S $\rightarrow$ andere Vorschrift)
 \begin{itemize}
  \item Berechne $u_{n,s}^F$ mit $u_{n,s+1}^F=u_{n,s}^F+\frac{\Delta t}{N_f} (f(u_{n,s}^F)+g(u_n^F))$ (expliziter Euler, mit altem Wert für langsamen Prozess)
  \item Berechne $u_{n+1}$ mit $u_{n+1}=u_{n}+\Delta t(f(u_{n+1})+g(u_{n+1}^F))$ mit $u_{n+1}^F=u_{n,N_{f}}^F$ (TODO: extrapolieren?)
 \end{itemize}

 Korrektor:
 \begin{itemize}
  \item $\delta_{m,s+1}^{F,k}=\delta^{F,k}_{m,s}+\Delta_{s}(f(u_{m,s}^{F,k+1})-f(u_{m,s}^{F,k})+g(u_{m}^{k+1})-g(u_m^k))+E_{m,s+1}(u^k)-E_{m,s}(u^k)$
  \item $\delta_{m+1}^{k+1}=\delta_{m}^{k+1}+\Delta_m (f(u_{m+1}^{F,k+1})-f(u_{m+1}^{F,k})+g(u_{m+1}^{k+1})-g(u_{m+1}^k))+E_{m+1}(u^k)-E_{m}(u^k)$
  \item $\delta_{m,0}^{F,k}=\delta_{m}^k$(???)
 \end{itemize}
 bzw. iterationen:
  \begin{itemize}
   \item $u_{m,s+1}^{F,k+1}=u_{m,s}^{F,k+1}+\Delta_{m,s}(f(u_{m,s}^{F,k+1})-f(u_{m,s}^{F,k})+g(u_{m}^{k+1})-g(u_m^k))+I_{s}^{s+1}(f(u^k)+g(u^k))$
   \item $u_{m,0}^{F,k+1}$:
    \begin{itemize}
     \item $u_{m,0}^{F,k+1}=u_{m}^{k+1}+\Delta_{m,0}(f(u_{m}^{k+1})-f(u_{m}^{k})+g(u_{m}^{k+1})-g(u_m^k))+I_{t_{m,0}}^{t_{m,1}}(f(u^k)+g(u^k))$ (besser)
     \item $u_{m,0}^{F,k+1}=u_{m-1,N_f}^{F,k+1}+\Delta_{m,0}(f(u_{m-1,N_f}^{F,k+1})-f(u_{m,N_f}^{F,k})+g(u_{m}^{k+1})-g(u_m^k))+I_{t_{m,0}}^{t_{m,1}}(f(u^k)+g(u^k))$ (schlechter)
    \end{itemize}
   \item $u_{m+1}^{k+1}=u_{m}^{k+1}+\Delta_{m} (f(\underbrace{u^{F,k+1}_{m+1}}_{u^{F,k+1}_{m,N_f}})-f(\underbrace{u^{F,k}_{m+1}}_{u^{F,k}_{m,N_f}})+g(u_{m+1}^{k+1})-g(u_{m+1}^k))+I_{m}^{m+1}(f(u^k)+g(u^k))$
   \item $I_s^{s+1}(\psi)=\int_{t_{m,s}}^{t_{m,s+1}} \psi(\tau) d\tau\approx \sum_l w_l \psi(c_l)$:
    \begin{itemize}
     \item $u^k$ von grober Skala: $$I_{s}^{s+1}(f(u^k)+g(u^k))\approx \sum_l w_l( f(u^k(c_l))+g(u^k(c_l)))$$, $u^k(t)=\sum_m u^k_m P_m^M(t)$, $P_m^M(t)$: Lagrange polynomial through $c_m$ of degree $M-1$
     \item $u^k$ von feiner Skala: $$I_s^{s+1} (f(u^k)+g(u^k))\approx \sum_l w_l (f(u^{F,k}(c_l))+g(u^{F,k}(c_l)))$$, $u^{F,k}(t)=\sum_m u^{F,k}_m P_m^P(t)$
     \item $u^k$ mixed: A more detailed explaination can be found in \cite{bouzarth2010multirate}, using explicit steps for every part
      \begin{align*}
        f(u^k(\tau))=& \sum_{l=1}^P f(u^{F,k}_{l}) L_l^P(\tau) \cr
         g(u^k(\tau))=&\sum_{l=1}^M g(u^{k}_l) L_l^M(\tau) \cr
 	I_{t_{m,s}}^{t_{m,s+1}}(f(u^k)+g(u^k))\approx & \sum_l^P w_l^P f(u^{F,k}_l) + \sum_{l}^M w_l^{M,s} g(u^k_l) \cr
 	w_l^{M,s}=&\int_{t_{m,s}}^{t_{m,s+1}} L_l^{M}(\tau) d\tau &\text{non classic}\cr
 	w_l^{P}=&\int_{t_{m,s}}^{t_{m,s+1}} L_l^P(\tau) d\tau & \text{classic}
      \end{align*}
    \end{itemize}
  \end{itemize}
  teste an $\dot u=\lambda_fu + \lambda_s u$, $u(0)=1.0$, $t_e=1.0$
 Stabilität, Testproblem: $M\dot u = Lu+B(t)u$, L: symmetrisch \& pos. Def., B(t): symmetrisch $\rightarrow (\lambda_f, \lambda_s)\in \mathbb{R}^2$
 
\paragraph{Some notes.}
Single SDC step for slow process $F_A$, which we treat implicitly even though it is the slow process:
\begin{equation*}
	u_{A,m+1}^{k+1} = u_{A,m}^{k+1} + \Delta t_m \left( F_{A}(u^{k+1}_{A,m+1}) -F_{A}(u^{k}_{m+1}) \right) + I_m^{m+1}\left( F_{A}(u^k) + F_{D}(u^k) \right).
\end{equation*}
Note that $u^k_{m+1}$ is equal to the \emph{fine} level solution at $t_{m+1}$ and is constructed from one of the sub collocation rules.
Single SDC step for fast process $F_D$, which we treat explicitly with small steps:
\begin{align*}
	u_{p+1}^{k+1} = u_{p}^{k+1} &+ \Delta t_p \left( F_{D}(u^{k+1}_{p}) - F_{D}(u^k_p) \right) \\
							   &+ \Delta t_p \left( F_{A}(u^{k+1}_{A,m+1}) - F_{A}(u^k_m) \right) \\
							   &+ I_p^{p+1}\left( F_A(u^k) + F_D(u^k) \right)
\end{align*}
The solution on the sub collocation nodes is the ``real" solution, that is $u^k$ contains all fine level solutions at $k$.
As $u^{k+1} - u^k \to 0$ and also $u^{k+1}_A - u^k \to 0$, we have
\begin{align*}
	u_{m+1} &= u_{m} + I_m^{m+1} \left( F_A(u) + F_D(u) \right) \\
	u_{p+1} &= u_{p} + I_{p}^{p+1} \left( F_A(u) + F_D(u) \right)
\end{align*}
so that we get convergence to the coarse and fine level collocation solutions.


\paragraph{Quantities to define.}
The Lagrange polynomials on $[T_n, T_{n+1}]$
\begin{equation}
	l_m(t), m = 1, \ldots, M \quad \text{with} \quad l_m(t_j) = \delta_{mj}.
\end{equation}
For each sub-step $[t_m, t_{m+1}]$, there are $P$ many Lagrange polynomials for the nodes $t_{m} \leq t_{m,1} < \ldots < t_{m,P} \leq t_{m+1}$:
\begin{equation}
	l_{m,p}(t), p=1, \ldots, P \quad \text{with} \quad l_{m,p}(t_{m,j}) = \delta_{pj}.
\end{equation}
Note that there are $M$ many polynomials $l_m(s)$ and $M \times P$ many $l_{m,p}$.
Also, there are $M$ many nodes $t_m$ and $M \times P$ many nodes $t_{m,p}$.
The ``standard" quadrature weights are
\begin{equation}
	s_{m,j} = \int_{t_m}^{t_{m+1}} l_j(s)~ds, \ m=1, \ldots, M; \ j=1, \ldots, M
\end{equation}
and
\begin{equation}
	s_{m,p,j} = \int_{t_{m,p}}^{t_{m,p+1}}  l_{m,j}(s)~ds, \ m=1, \ldots, M; \ p=1, \ldots, P; \ j=1, \ldots, P.
\end{equation}
In addition, we will need the ``mixed" weights
\begin{equation}
	\tilde{s}_{m,n,p} := \int_{t_{m,p}}^{t_{m,p+1}} l_{n}(s)~ds, m=1, \ldots, M; \ n=1, \ldots, M; p=1, \ldots, P
\end{equation}
and
\begin{equation}
	\hat{s}_{m,p,j} := \int_{t_{m,p}}^{t_{m,p+1}} l_{m,j}(s)~ds, m=1, \ldots, M; p=1, \ldots, P; j=1, \ldots, P.
\end{equation}
\bibliography{refs}
\end{document}
